<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SketchPad — smooth drawing app</title>
<style>
  :root{
    --bg:#0f1724;
    --panel:#0b1220;
    --accent:#7c3aed;
    --muted:#94a3b8;
    --ui-bg: #0b1320;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,#061026 0%, #071229 50%, #071827 100%);
    color:#e6eef8;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    -webkit-font-smoothing:antialiased;
  }

  /* App container */
  .app{
    width:100%;
    max-width:1100px;
    height:80vh;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:14px;
    display:flex;
    overflow:hidden;
    box-shadow: 0 10px 40px rgba(2,6,23,0.7);
    border: 1px solid rgba(255,255,255,0.03);
  }

  /* Left toolbar */
  .toolbar{
    width:280px;
    padding:18px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-right:1px solid rgba(255,255,255,0.02);
    display:flex;
    flex-direction:column;
    gap:14px;
  }

  .brand{
    display:flex;
    gap:10px;
    align-items:center;
    margin-bottom:2px;
  }
  .logo{
    width:44px;height:44px;border-radius:10px;
    background:linear-gradient(135deg,var(--accent),#4f46e5);
    display:grid;place-items:center;font-weight:700;color:white;
    box-shadow:0 6px 18px rgba(124,58,237,0.18);
  }
  .title{
    line-height:1;
  }
  .title h1{margin:0;font-size:16px}
  .title p{margin:0;font-size:12px;color:var(--muted)}

  /* controls sections */
  .section{background:var(--glass); padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.02)}
  .section h3{margin:0 0 8px 0;font-size:13px;color:var(--muted)}
  .tool-grid{display:flex;flex-wrap:wrap;gap:8px}

  /* tool buttons */
  .btn{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03);
    color:inherit;
    padding:8px 10px;
    border-radius:10px;
    display:inline-flex;align-items:center;gap:8px;
    cursor:pointer; user-select:none;
    transition: transform .18s cubic-bezier(.2,.9,.3,1), box-shadow .18s;
    box-shadow: 0 6px 14px rgba(0,0,0,0.45);
    font-size:13px;
  }
  .btn:hover{transform:translateY(-4px); box-shadow: 0 12px 28px rgba(0,0,0,0.55)}
  .btn:active{transform:translateY(-1px) scale(.995)}
  .btn.active{outline:2px solid rgba(124,58,237,0.18); box-shadow: 0 14px 30px rgba(124,58,237,0.08); transform:translateY(-6px)}

  .tools-row{display:flex;gap:8px;flex-wrap:wrap}
  .ico{width:18px;height:18px;display:inline-block;opacity:.95}

  /* color swatches */
  .swatches{display:flex;gap:8px;flex-wrap:wrap}
  .swatch{
    width:30px;height:30px;border-radius:8px;border:1px solid rgba(0,0,0,0.35); cursor:pointer;
    transition: transform .14s ease, box-shadow .14s; box-shadow: 0 6px 14px rgba(0,0,0,0.45);
  }
  .swatch:hover{transform:translateY(-4px)}
  .swatch.selected{outline:3px solid rgba(255,255,255,0.06); box-shadow: 0 12px 24px rgba(0,0,0,0.6)}

  /* thickness presets and slider */
  .thickness-presets{display:flex;gap:8px;align-items:center}
  .thick-btn{width:44px;height:36px;border-radius:8px;display:grid;place-items:center;padding:6px;cursor:pointer;border:1px solid rgba(255,255,255,0.03); background:transparent}
  .thick-btn .dot{border-radius:50%; background:linear-gradient(180deg,#fff,#ddd); opacity:.95}
  .thick-btn.active{outline:2px solid rgba(124,58,237,0.16); transform:translateY(-4px)}

  input[type=range]{width:100%; accent-color:var(--accent)}

  /* canvas area */
  .canvas-wrap{
    flex:1;
    position:relative;
    display:flex;
    flex-direction:column;
  }
  .canvas-top{
    display:flex;
    justify-content:space-between;
    gap:12px;
    padding:14px;
    align-items:center;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    border-bottom:1px solid rgba(255,255,255,0.02);
  }
  .status{color:var(--muted);font-size:13px}
  .actions{display:flex;gap:8px;align-items:center}

  /* main canvas */
  canvas{
    flex:1;
    background: linear-gradient(180deg,#0b1020, #071124);
    display:block;
    width:100%;
    height:100%;
    cursor:crosshair;
  }

  .mini{
    font-size:12px;color:var(--muted)
  }

  footer.attribution{
    padding:10px 14px;color:var(--muted);font-size:12px;background:transparent;border-top:1px solid rgba(255,255,255,0.01)
  }

  /* small responsive */
  @media (max-width:900px){
    .app{flex-direction:column;height:88vh}
    .toolbar{width:100%;display:flex;flex-direction:row;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;padding:12px}
    .canvas-wrap{height:calc(100% - 120px)}
    canvas{height:100%}
  }
</style>
</head>
<body>
<div class="app">
  <div class="toolbar">
    <div class="brand">
      <div class="logo">S</div>
      <div class="title"><h1>SketchPad</h1><p>smooth + snappy drawing</p></div>
    </div>

    <div class="section">
      <h3>Tools</h3>
      <div class="tools-row" role="toolbar" aria-label="tools">
        <button class="btn tool active" data-tool="pen" title="Pen">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
          Pen
        </button>

        <button class="btn tool" data-tool="eraser" title="Eraser">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M16.24 11.51L12.49 7.76 7.76 12.49l3.75 3.75-1.76 1.76a2 2 0 0 0 0 2.83l1.18 1.18a2 2 0 0 0 2.83 0l6.04-6.04a2 2 0 0 0 0-2.83l-3.75-3.75z"/></svg>
          Eraser
        </button>

        <button class="btn tool" data-tool="line" title="Line">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M3 21h18v-2H3v2zm3-9l10-7 1.5 2L7.5 14 6 12z"/></svg>
          Line
        </button>

        <button class="btn tool" data-tool="rect" title="Rectangle">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M4 4h16v16H4z"/></svg>
          Rect
        </button>

        <button class="btn tool" data-tool="circle" title="Circle">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2z"/></svg>
          Circle
        </button>

        <button class="btn tool" data-tool="eyedrop" title="Eyedropper">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M19.73 4.27a.998.998 0 0 0-1.41 0l-2.88 2.88-1.06-1.06 2.88-2.88a2.828 2.828 0 0 1 4 4l-2.53 2.53 1.06 1.06L19.73 4.27zM3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/></svg>
          Pick
        </button>
      </div>
    </div>

    <div class="section">
      <h3>Colors</h3>
      <div class="swatches" id="swatches">
        <!-- preset swatches inserted by JS -->
      </div>

      <div style="height:8px"></div>
      <div style="display:flex;gap:8px;align-items:center;">
        <input id="customColor" type="color" value="#ff6b6b" title="Choose custom color" style="width:46px;height:36px;border-radius:8px;border:none;cursor:pointer;padding:0" />
        <div style="flex:1">
          <div style="font-size:12px;color:var(--muted)">Custom</div>
        </div>
      </div>
    </div>

    <div class="section">
      <h3>Thickness</h3>
      <div class="thickness-presets">
        <button class="thick-btn thick preset" data-size="2" title="Thin">
          <div class="dot" style="width:6px;height:6px"></div>
        </button>
        <button class="thick-btn thick preset active" data-size="6" title="Medium">
          <div class="dot" style="width:10px;height:10px"></div>
        </button>
        <button class="thick-btn thick preset" data-size="12" title="Thicc">
          <div class="dot" style="width:14px;height:14px"></div>
        </button>
        <button class="thick-btn thick preset" data-size="24" title="Huge">
          <div class="dot" style="width:20px;height:20px"></div>
        </button>
      </div>

      <div style="margin-top:10px">
        <input id="sizeRange" type="range" min="1" max="60" value="6" />
        <div class="mini" style="margin-top:6px">Size: <span id="sizeLabel">6</span> px</div>
      </div>
    </div>

    <div class="section">
      <h3>Actions</h3>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" id="undoBtn" title="Undo">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M12 5V1L7 6l5 5V7c3.86 0 7 3.14 7 7 0 .34-.03.67-.08 1H22c.05-.33.08-.66.08-1 0-4.97-4.03-9-9-9z"/></svg> Undo
        </button>
        <button class="btn" id="clearBtn" title="Clear">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg> Clear
        </button>
        <button class="btn" id="saveBtn" title="Save PNG">
          <svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M5 5v14h14V5H5zm7 10l4-5h-3V7h-2v3H8l4 5z"/></svg> Save
        </button>
      </div>
    </div>

    <div class="section" style="margin-top:auto">
      <h3>Shortcuts</h3>
      <div class="mini">T: toggle tools panel (mobile)<br>U: undo • C: clear • S: save</div>
    </div>

  </div>

  <div class="canvas-wrap">
    <div class="canvas-top">
      <div class="status" id="status">Tool: <strong id="curTool">Pen</strong> • Color: <span id="curColor">#ff6b6b</span></div>
      <div class="actions">
        <div class="mini">Presets: <span id="sizePreview">6px</span></div>
      </div>
    </div>

    <canvas id="sketch"></canvas>
    <footer class="attribution">Made with ✨ — try pen + line together. Resize browser to test responsiveness.</footer>
  </div>
</div>

<script>
/* ====== SketchPad App JS ====== */

(() => {
  const canvas = document.getElementById('sketch');
  const ctx = canvas.getContext('2d', { alpha: true });

  // fullscreen-ish canvas fit
  function resizeCanvas() {
    // preserve content by copying to temporary canvas
    const tmp = document.createElement('canvas');
    tmp.width = canvas.width;
    tmp.height = canvas.height;
    const tctx = tmp.getContext('2d');
    tctx.drawImage(canvas, 0, 0);

    const w = canvas.parentElement.clientWidth;
    const h = canvas.parentElement.clientHeight - document.querySelector('.canvas-top').offsetHeight - 1;
    canvas.width = Math.max(600, Math.floor(w)); // ensure good resolution
    canvas.height = Math.max(400, Math.floor(h));
    // redraw saved image scaled to new size
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(tmp, 0, 0, canvas.width, canvas.height);
  }
  window.addEventListener('resize', resizeCanvas);

  // initial size
  resizeCanvas();

  // state
  let state = {
    tool: 'pen',
    color: '#ff6b6b',
    size: 6,
    drawing: false,
    last: { x:0, y:0 },
    lastMid: { x:0, y:0 },
    history: [],
    historyIndex: -1,
    maxHistory: 25,
    startPoint: null, // for shape start
  };

  // UI elements
  const tools = document.querySelectorAll('.tool');
  const curToolLabel = document.getElementById('curTool');
  const curColorLabel = document.getElementById('curColor');
  const swatchesEl = document.getElementById('swatches');
  const customColor = document.getElementById('customColor');
  const sizeRange = document.getElementById('sizeRange');
  const sizeLabel = document.getElementById('sizeLabel');
  const sizePreview = document.getElementById('sizePreview');
  const presets = document.querySelectorAll('.preset');
  const undoBtn = document.getElementById('undoBtn');
  const clearBtn = document.getElementById('clearBtn');
  const saveBtn = document.getElementById('saveBtn');

  // color presets
  const colors = ['#0ea5a4','#7c3aed','#ef4444','#ff6b6b','#f59e0b','#10b981','#3b82f6','#e879f9'];
  function buildSwatches(){
    swatchesEl.innerHTML = '';
    colors.forEach(c=>{
      const el = document.createElement('button');
      el.className = 'swatch';
      el.style.background = c;
      el.dataset.color = c;
      el.title = c;
      el.addEventListener('click', ()=> selectColor(c, el));
      swatchesEl.appendChild(el);
    });
    // select first
    selectColor(customColor.value);
  }
  buildSwatches();

  function selectColor(c, swatchEl){
    state.color = c;
    curColorLabel.textContent = c;
    customColor.value = c;
    // mark selection
    document.querySelectorAll('.swatch').forEach(s=> s.classList.toggle('selected', s.dataset.color===c));
  }

  customColor.addEventListener('input', (e)=>{
    selectColor(e.target.value);
  });

  // tool selection
  tools.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      document.querySelectorAll('.tool').forEach(t=>t.classList.remove('active'));
      btn.classList.add('active');
      state.tool = btn.dataset.tool;
      curToolLabel.textContent = capitalize(state.tool);
    });
  });

  // thickness presets & slider
  function setSize(s){
    state.size = Number(s);
    sizeRange.value = s;
    sizeLabel.textContent = s;
    sizePreview.textContent = s + 'px';
    document.querySelectorAll('.preset').forEach(p => p.classList.toggle('active', Number(p.dataset.size)===Number(s)));
  }
  presets.forEach(p=>{
    p.addEventListener('click', ()=> setSize(p.dataset.size));
  });
  sizeRange.addEventListener('input', (e)=> setSize(e.target.value));
  setSize(6);

  // helper
  function getCanvasPos(e){
    const rect = canvas.getBoundingClientRect();
    if(e.touches && e.touches[0]) e = e.touches[0];
    return { x: (e.clientX - rect.left) * (canvas.width / rect.width), y: (e.clientY - rect.top) * (canvas.height / rect.height) };
  }
  function capitalize(s){return s[0].toUpperCase()+s.slice(1)}

  // history (undo)
  function pushHistory(){
    try {
      if(state.historyIndex < state.history.length - 1){
        // if undone some steps then new draw should drop future states
        state.history = state.history.slice(0, state.historyIndex+1);
      }
      const data = ctx.getImageData(0,0,canvas.width,canvas.height);
      state.history.push(data);
      if(state.history.length > state.maxHistory) state.history.shift();
      state.historyIndex = state.history.length - 1;
      // tiny visual feedback
      undoBtn.animate([{ transform: 'translateY(0)'},{ transform:'translateY(-4px)'},{ transform:'translateY(0)'}], {duration:260});
    } catch(e){ console.warn('history push failed', e) }
  }
  function undo(){
    if(state.historyIndex <= 0) {
      // clear canvas fallback
      ctx.clearRect(0,0,canvas.width,canvas.height);
      state.history = [];
      state.historyIndex = -1;
      return;
    }
    state.historyIndex--;
    const imageData = state.history[state.historyIndex];
    ctx.putImageData(imageData, 0, 0);
  }
  undoBtn.addEventListener('click', ()=> { undo(); });

  // actions
  clearBtn.addEventListener('click', ()=>{
    ctx.clearRect(0,0,canvas.width,canvas.height);
    pushHistory();
  });

  saveBtn.addEventListener('click', ()=>{
    const link = document.createElement('a');
    link.download = 'sketch.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  });

  // drawing utilities: smooth pen via quadratic curves
  function beginStroke(x,y){
    state.drawing = true;
    state.last.x = x; state.last.y = y;
    state.lastMid.x = x; state.lastMid.y = y;
    state.startPoint = {x,y};
    if(state.tool === 'pen'){
      ctx.save();
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.strokeStyle = state.color;
      ctx.lineWidth = state.size;
      ctx.globalCompositeOperation = 'source-over';
      ctx.beginPath();
      ctx.moveTo(x,y);
    } else if(state.tool === 'eraser'){
      ctx.save();
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.globalCompositeOperation = 'destination-out';
      ctx.lineWidth = state.size;
      ctx.beginPath();
      ctx.moveTo(x,y);
    }
  }

  function continueStroke(x,y){
    if(!state.drawing) return;
    if(state.tool === 'pen' || state.tool === 'eraser'){
      // midpoint smoothing
      const midX = (state.last.x + x)/2;
      const midY = (state.last.y + y)/2;
      ctx.quadraticCurveTo(state.last.x, state.last.y, midX, midY);
      ctx.stroke();
      state.last.x = x; state.last.y = y;
    } else {
      // for shapes, we do a preview by redrawing from last saved state
      // restore last snapshot (before starting shape)
      if(state._shapeBackup){
        ctx.putImageData(state._shapeBackup, 0, 0);
      }
      const sx = state.startPoint.x;
      const sy = state.startPoint.y;
      const w = x - sx;
      const h = y - sy;
      ctx.save();
      ctx.strokeStyle = state.color;
      ctx.lineWidth = state.size;
      ctx.globalCompositeOperation = 'source-over';
      ctx.setLineDash([]);
      if(state.tool === 'line'){
        ctx.beginPath();
        ctx.moveTo(sx, sy);
        ctx.lineTo(x, y);
        ctx.stroke();
      } else if(state.tool === 'rect'){
        ctx.strokeRect(sx, sy, w, h);
      } else if(state.tool === 'circle'){
        ctx.beginPath();
        const r = Math.hypot(w, h);
        ctx.arc(sx, sy, r, 0, Math.PI*2);
        ctx.stroke();
      }
      ctx.restore();
    }
  }

  function endStroke(x,y){
    if(!state.drawing) return;
    if(state.tool === 'pen' || state.tool === 'eraser'){
      ctx.closePath();
      ctx.restore();
    } else {
      // shapes: a final draw already rendered in continueStroke; nothing extra
      if(state._shapeBackup){ state._shapeBackup = null; }
    }
    state.drawing = false;
    state.startPoint = null;
    pushHistory();
  }

  // pointer handlers
  function pointerDown(e){
    e.preventDefault();
    const p = getCanvasPos(e);
    // eyedropper picks color and stops
    if(state.tool === 'eyedrop'){
      const data = ctx.getImageData(Math.floor(p.x), Math.floor(p.y), 1, 1).data;
      const picked = rgbToHex(data[0], data[1], data[2]);
      selectColor(picked);
      return;
    }
    beginStroke(p.x, p.y);
    if(state.tool !== 'pen' && state.tool !== 'eraser'){
      // save snapshot to preview shape
      try { state._shapeBackup = ctx.getImageData(0,0,canvas.width,canvas.height); } catch(e){ state._shapeBackup = null; }
    }
  }

  function pointerMove(e){
    if(!state.drawing) return;
    const p = getCanvasPos(e);
    continueStroke(p.x, p.y);
  }

  function pointerUp(e){
    if(!state.drawing) return;
    const p = getCanvasPos(e);
    endStroke(p.x, p.y);
  }

  // attach mouse & touch events
  canvas.addEventListener('mousedown', pointerDown);
  canvas.addEventListener('mousemove', pointerMove);
  window.addEventListener('mouseup', pointerUp);

  canvas.addEventListener('touchstart', pointerDown, {passive:false});
  canvas.addEventListener('touchmove', pointerMove, {passive:false});
  window.addEventListener('touchend', pointerUp);

  // eyedropper, pick color from canvas on click -> implemented above

  // utility rgb -> hex
  function componentToHex(c){ const hex = c.toString(16); return hex.length==1 ? "0"+hex : hex; }
  function rgbToHex(r,g,b){ return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b); }

  // keyboard shortcuts
  window.addEventListener('keydown', (e) => {
    if(e.key.toLowerCase() === 'u'){ undo(); }
    if(e.key.toLowerCase() === 'c'){ ctx.clearRect(0,0,canvas.width,canvas.height); pushHistory(); }
    if(e.key.toLowerCase() === 's'){ saveBtn.click(); }
  });

  // set initial history snapshot
  pushHistory();

  // sync UI to state periodically
  function applyStateToCursor(){
    if(state.tool === 'eraser'){
      canvas.style.cursor = 'crosshair';
    } else {
      canvas.style.cursor = 'crosshair';
    }
  }
  applyStateToCursor();

  // watch for color/size changes used in drawing by referencing state when starting each stroke
  // small improvements: throttle resizing and initial draw
  // onboarding: update UI labels
  function updateLabels(){
    document.getElementById('curColor').textContent = state.color;
    sizeLabel.textContent = state.size;
    sizePreview.textContent = state.size + 'px';
  }
  // keep state synced with UI color input
  customColor.addEventListener('change', (e) => { selectColor(e.target.value); updateLabels(); });

  // simple UI interactions: click swatch event already sets state and labels
  // update labels on size change
  sizeRange.addEventListener('change', updateLabels);
  presets.forEach(p => p.addEventListener('click', updateLabels));

  // initial update
  updateLabels();

  // small accessibility: trap right-click to not open context menu when drawing
  canvas.addEventListener('contextmenu', (e)=> e.preventDefault());

  // expose some functions for debugging (optional)
  window.__sketchpad = { canvas, ctx, state, pushHistory, undo };

})();
</script>
</body>
</html>
