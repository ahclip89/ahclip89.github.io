<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Cube with Physics Ball</title>
<style>
  body { margin: 0; overflow: hidden; background: #111; }
  canvas { display: block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const cw = canvas.width / 2;
const ch = canvas.height / 2;

// Cube definition
const cubeSize = 200;
let angleX = 0;
let angleY = 0;
const cubeVertices = [
  [-1,-1,-1], [1,-1,-1], [1,1,-1], [-1,1,-1],
  [-1,-1,1], [1,-1,1], [1,1,1], [-1,1,1]
];

const cubeEdges = [
  [0,1],[1,2],[2,3],[3,0],
  [4,5],[5,6],[6,7],[7,4],
  [0,4],[1,5],[2,6],[3,7]
];

// Ball physics
let ball = {
  pos: { x: 0, y: 0, z: 0 },
  vel: { x: 2, y: 3, z: 2.5 },
  radius: 20
};

function rotate(vertex, ax, ay) {
  let [x,y,z] = vertex;

  // rotate around X
  let cosX = Math.cos(ax), sinX = Math.sin(ax);
  let y1 = y*cosX - z*sinX;
  let z1 = y*sinX + z*cosX;

  // rotate around Y
  let cosY = Math.cos(ay), sinY = Math.sin(ay);
  let x2 = x*cosY + z1*sinY;
  let z2 = -x*sinY + z1*cosY;

  return [x2, y1, z2];
}

function project([x,y,z]) {
  const fov = 500;
  const scale = fov / (fov + z);
  return {
    x: x * cubeSize * scale + cw,
    y: y * cubeSize * scale + ch
  };
}

function updateBall() {
  ball.pos.x += ball.vel.x;
  ball.pos.y += ball.vel.y;
  ball.pos.z += ball.vel.z;

  const limit = cubeSize - ball.radius;

  if(ball.pos.x > limit || ball.pos.x < -limit) ball.vel.x *= -1;
  if(ball.pos.y > limit || ball.pos.y < -limit) ball.vel.y *= -1;
  if(ball.pos.z > limit || ball.pos.z < -limit) ball.vel.z *= -1;
}

function drawCube() {
  let projected = cubeVertices.map(v => project(rotate(v, angleX, angleY)));
  ctx.strokeStyle = '#0f0';
  ctx.lineWidth = 2;
  cubeEdges.forEach(([i,j]) => {
    ctx.beginPath();
    ctx.moveTo(projected[i].x, projected[i].y);
    ctx.lineTo(projected[j].x, projected[j].y);
    ctx.stroke();
  });
}

function drawBall() {
  const p = project([ball.pos.x/cubeSize, ball.pos.y/cubeSize, ball.pos.z/cubeSize]);
  ctx.fillStyle = '#f00';
  ctx.beginPath();
  ctx.arc(p.x, p.y, ball.radius * (500 / (500 + ball.pos.z)), 0, Math.PI*2);
  ctx.fill();
}

function animate() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  angleX += 0.01;
  angleY += 0.01;
  updateBall();
  drawCube();
  drawBall();
  requestAnimationFrame(animate);
}

animate();

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>
</body>
</html>
